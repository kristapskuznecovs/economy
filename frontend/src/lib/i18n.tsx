import { createContext, useContext, useEffect, useMemo, useState, type ReactNode } from 'react';

export type Locale = 'lv' | 'en';

type I18nContextValue = {
  locale: Locale;
  setLocale: (locale: Locale) => void;
  t: (key: string, vars?: Record<string, string | number>) => string;
};

const STORAGE_KEY = 'economy_locale';

const DICTIONARY: Record<Locale, Record<string, string>> = {
  lv: {
    'header.title': 'Latvijas valdības budžeta plūsmas panelis',
    'header.subtitle': 'Fiskālā caurskatāmība un politikas simulācijas',
    'header.home': 'Sākums',
    'header.savedViews': 'Saglabātie skati',
    'header.docs': 'Dokumentācija',
    'header.data': 'Dati: A',
    'header.dataFreshness': 'Datu aktualitāte',
    'header.dataFreshness.stateBudget': 'Valsts budžeta resori: pirms 12 dienām',
    'header.dataFreshness.csb': 'CSP Latvija: pirms 5 dienām',
    'header.dataFreshness.ioTables': 'I/O tabulas: pirms 45 dienām',
    'header.langLabel': 'Valoda',
    'index.detailsButton': 'Ieņēmumu un izdevumu detaļas',
    'index.tab.impact': 'Ietekme',
    'index.tab.why': 'Kāpēc',
    'index.tab.map': 'Karte',
    'index.tab.flow': 'Plūsma',
    'index.tab.details': 'Detaļas',
    'globalAsk.title': 'Jautā Fiscal AI',
    'globalAsk.placeholder': 'Uzdod fiskālu jautājumu (piem., simulēt 2. pensiju līmeņa atcelšanu)',
    'globalAsk.parseFailed': 'Politikas parsēšana neizdevās',
    'globalAsk.decision.auto_proceed':
      'Augsta pārliecība: simulācija tiks palaista automātiski.',
    'globalAsk.decision.proceed_with_warning':
      'Laba pārliecība ar pieņēmumiem: simulācija tiks palaista ar brīdinājumu.',
    'globalAsk.decision.require_confirmation':
      'Vidēja pārliecība: pārskati interpretāciju un apstiprini pirms simulācijas.',
    'globalAsk.decision.blocked_for_clarification':
      'Bloķēts: pirms simulācijas precizē trūkstošās detaļas.',
    'globalAsk.parseFailedFallback': '{message} Simulācija tiks palaista bez parsera.',
    'globalAsk.failedToParse': 'Neizdevās parsēt politiku',
    'globalAsk.parser': 'Parseris',
    'globalAsk.confidence': 'Pārliecība',
    'globalAsk.type': 'Tips',
    'globalAsk.category': 'Kategorija',
    'globalAsk.policyInterpretation': 'Politikas interpretācija',
    'globalAsk.reasoning': 'Pamatojums',
    'globalAsk.parameterChanges': 'Parametru izmaiņas',
    'globalAsk.ambiguities': 'Neskaidrības',
    'globalAsk.runWithInterpretation': 'Palaist simulāciju ar šo interpretāciju',
    'globalAsk.clarificationRequired': 'Nepieciešams precizējums',
    'globalAsk.answerPlaceholder': 'Ieraksti atbildi...',
    'globalAsk.reparse': 'Pārparsēt ar precizējumiem',
    'quickPrompt.1': 'Simulēt 2. pensiju līmeņa atcelšanu',
    'quickPrompt.2': 'Kas notiek, ja veselības budžetu palielina par €100M?',
    'quickPrompt.3': 'Samazināt aizsardzības budžetu par 20%',
    'quickPrompt.4': 'Pārdalīt ES fondus izglītībai',
    'horizon.gdp': 'IKP',
    'horizon.jobs': 'Darbvietas',
    'horizon.budget': 'Budžets',
    'horizon.inflation': 'Inflācija',
    'horizon.year': '{year}. gads',
    'horizon.yearImpact': '{year}. gada ietekme',
    'horizon.askAbove': 'Uzdod jautājumu augstāk',
    'why.title': 'Kāpēc tas notiek',
    'why.causalChain': 'Cēloņsakarību ķēde',
    'why.keyDrivers': 'Galvenie virzītāji',
    'why.winners': 'Ieguvēji',
    'why.losers': 'Zaudētāji',
    'interactive.title': 'Budžeta plūsma: no ieņēmumiem uz izdevumiem',
    'interactive.subtitle': 'Interaktīva Sankey diagramma - virziet peli virs mezgliem un saitēm',
    'interactive.revenue': 'Ieņēmumi',
    'interactive.expenditure': 'Izdevumi',
    'interactive.period': 'Periods',
    'interactive.year': 'Gads',
    'interactive.loading': 'Ielādē budžeta sadalījumu no data.gov.lv...',
    'interactive.loadFail': 'Neizdevās ielādēt tiešsaistes datus. Parādīti lokālie dati.',
    'interactive.source': 'Avots',
    'sankey.title': 'Cik tiek novirzīts no 1 nodokļos iemaksātā eiro?',
    'sankey.subtitle': 'Saeimas balsojuma loģika pēc resoriem un ministrijām',
    'sankey.total': 'Kopā',
    'sankey.period': 'Periods',
    'sankey.loading': 'Ielādē budžeta sadalījumu no data.gov.lv...',
    'sankey.loadFail': 'Neizdevās ielādēt tiešsaistes datus. Parādīti lokālie dati.',
    'sankey.chartTitle': 'Visas ministrijas: vertikāls stabiņu grafiks',
    'sankey.chartSubtitle': 'Pilnais sadalījums pa resoriem ({count} ieraksti)',
    'sankey.tableTitle': 'Atvērtie dati: izdevumu tabula pēc ministrijām',
    'sankey.colMinistry': 'Ministrija / resors',
    'sankey.colEuro': 'No €1 (centi)',
    'sankey.colAmount': 'Summa (€M)',
    'sankey.colShare': 'Daļa (%)',
    'sankey.source': 'Avots',
    'sankey.cents': 'centi',
    'sankey.amountLabel': 'Summa',
    'history.title': 'Izdevumu izmaiņu pārlūks',
    'history.subtitle': 'Maini grupu un skati 1 gadu vai visu periodu no 2010. gada.',
    'history.period': 'Pieejamais periods',
    'history.loading': 'Ielādē vēsturiskos izdevumu datus...',
    'history.failed': 'Neizdevās ielādēt vēsturi',
    'history.group': 'Izdevumu grupa',
    'history.tabSingle': '1 gada skats',
    'history.tabAll': 'Visu gadu skats',
    'history.selectedYear': 'Izvēlētais gads',
    'history.yearRange': 'Gadu diapazons',
    'history.yearsShown': 'Parādītie gadi',
    'history.metricAmount': 'Apjoms (€M)',
    'history.metricBaseEur': 'Pret bāzi (€M)',
    'history.metricBasePct': 'Pret bāzi (%)',
    'history.metricYoyPct': 'Gada izmaiņa (%)',
    'history.na': 'nav',
    'period.from': 'No',
    'period.to': 'Līdz',
    'period.modeYear': 'Gads',
    'period.modeRange': 'Diapazons',
    'revenueHistory.title': 'Ieņēmumu avotu izmaiņu pārlūks',
    'revenueHistory.subtitle': 'Vertikāls stabiņu grafiks pa avotiem ar YoY izmaiņām (sākot no 2010, ja pieejami dati).',
    'revenueHistory.loading': 'Ielādē ieņēmumu avotu datus...',
    'revenueHistory.failed': 'Neizdevās ielādēt ieņēmumu avotus',
    'revenueHistory.total': 'Kopā',
    'revenueHistory.period': 'Pieejamais periods',
    'revenueHistory.selectedYear': 'Izvēlētais gads',
    'revenueHistory.range': 'Gadu diapazons',
    'revenueHistory.rangeApplied': 'Piemērots diapazons',
    'revenueHistory.yoyBasis': 'YoY bāzes gads',
    'revenueHistory.chartTitle': 'Ieņēmumu avoti: vertikāls stabiņu grafiks',
    'revenueHistory.chartSubtitle': 'Dažādas krāsas katram ieņēmumu avotam',
    'revenueHistory.tableTitle': 'Ieņēmumu avotu tabula',
    'revenueHistory.amount': 'Summa',
    'revenueHistory.yoy': 'YoY',
    'revenueHistory.colSource': 'Ieņēmumu avots',
    'revenueHistory.colAmount': 'Summa (€M)',
    'revenueHistory.colShare': 'Daļa (%)',
    'revenueHistory.colYoy': 'YoY (%)',
    'revenueHistory.otherBreakdown': 'Citi ieņēmumi: detalizācija',
    'trade.title': 'Ārējā tirdzniecība pa valstīm',
    'trade.subtitle': 'Tirdzniecības bilance un vērtības pa partnervalstīm',
    'trade.loading': 'Ielādē tirdzniecības datus...',
    'trade.failed': 'Neizdevās ielādēt tirdzniecības datus',
    'trade.period': 'Pieejamais periods',
    'trade.year': 'Izvēlētais gads',
    'trade.selectorMode': 'Skata režīms',
    'trade.rangeNote': 'Diapazona skatā summas tiek summētas pa izvēlētajiem gadiem.',
    'trade.exports': 'Eksports',
    'trade.imports': 'Imports',
    'trade.deficit': 'Tirdzniecības deficīts',
    'trade.surplus': 'Tirdzniecības pārpalikums',
    'trade.balance': 'Bilance',
    'trade.chartTitle': 'Bilance pa valstīm',
    'trade.chartSubtitle': 'Zaļš = pārpalikums, sarkans = deficīts',
    'trade.tableTitle': 'Top partnervalstis',
    'trade.country': 'Valsts',
    'trade.exportsShort': 'Eksports (€M)',
    'trade.importsShort': 'Imports (€M)',
    'trade.balanceShort': 'Bilance (€M)',
    'economyStructure.title': 'Ekonomikas struktūra un remittances',
    'economyStructure.subtitle': 'Pakalpojumi/ražošana, eksporta grupas un ārvalstīs strādājošo pārvedumi',
    'economyStructure.loading': 'Ielādē ekonomikas struktūras datus...',
    'economyStructure.failed': 'Neizdevās ielādēt ekonomikas struktūras datus',
    'economyStructure.period': 'Pieejamais periods',
    'economyStructure.year': 'Izvēlētais gads',
    'economyStructure.selectorMode': 'Skata režīms',
    'economyStructure.rangeNote': 'Diapazona skatā summas tiek summētas, bet procenti tiek vidēti pa gadiem.',
    'economyStructure.totalExports': 'Kopējais eksports',
    'economyStructure.servicesEconomy': 'Pakalpojumu ekonomika (% no IKP)',
    'economyStructure.productionEconomy': 'Ražošanas ekonomika (% no IKP)',
    'economyStructure.agriculture': 'Lauksaimniecība (% IKP)',
    'economyStructure.industry': 'Rūpniecība (% IKP)',
    'economyStructure.manufacturingExports': 'Ražošana+koksne preču eksportā (%)',
    'economyStructure.itExports': 'IKT pakalpojumi (komercpakalpojumu eksportā, %)',
    'economyStructure.remittancesValue': 'Pārvedumi no ārvalstīm ($M)',
    'economyStructure.remittancesShare': 'Pārvedumi (% no IKP)',
    'economyStructure.chartTitle': 'Eksporta sastāvs pa grupām',
    'economyStructure.chartSubtitle': 'Preču eksports (TOTAL) pa CN2 grupējumiem',
    'economyStructure.tableTitle': 'Eksporta grupu tabula',
    'economyStructure.shareMiniTitle': 'Eksporta īpatsvari (%)',
    'economyStructure.viewTable': 'Tabula',
    'economyStructure.viewChart': 'Diagramma',
    'economyStructure.denominatorNote': 'Piezīme: IKT īpatsvars tiek rēķināts no pakalpojumu eksporta, bet diagramma zemāk ir tikai preču (CN2) eksports.',
    'economyStructure.groupCol': 'Grupa',
    'economyStructure.amountCol': 'Summa (€M)',
    'economyStructure.shareCol': 'Daļa (%)',
    'economyStructure.amount': 'Summa',
    'economyStructure.group.manufacturing_other': 'Ražošana (citi produkti)',
    'economyStructure.group.lumber_wood': 'Koksne un papīrs',
    'economyStructure.group.agriculture_food': 'Lauksaimniecība un pārtika',
    'economyStructure.group.other_goods': 'Citas preces',
    'expenditurePositions.title': 'Lielākās izdevumu pozīcijas',
    'expenditurePositions.subtitle': 'Top izdevumi pēc EKK, programmām, iestādēm vai ministrijām',
    'expenditurePositions.total': 'Kopējie izdevumi',
    'expenditurePositions.period': 'Periods',
    'expenditurePositions.year': 'Gads',
    'expenditurePositions.group': 'Grupēt pēc',
    'expenditurePositions.group.ekk': 'EKK',
    'expenditurePositions.group.program': 'Programma',
    'expenditurePositions.group.institution': 'Iestāde',
    'expenditurePositions.group.ministry': 'Ministrija',
    'expenditurePositions.loading': 'Ielādē izdevumu pozīcijas...',
    'expenditurePositions.failed': 'Neizdevās ielādēt izdevumu pozīcijas',
    'expenditurePositions.chartTitle': 'Top pozīcijas: vertikāls stabiņu grafiks',
    'expenditurePositions.tableTitle': 'Top pozīciju tabula',
    'expenditurePositions.colPosition': 'Pozīcija',
    'expenditurePositions.colAmount': 'Summa (€M)',
    'expenditurePositions.colShare': 'Daļa (%)',
    'expenditurePositions.amount': 'Summa',
    'expenditurePositions.source': 'Avots',
    'procurement.title': 'Iepirkumu optimizācijas KPI',
    'procurement.subtitle': 'Procurement proxy + top pasūtītāji/piegādātāji no pieejamajiem datiem',
    'procurement.period': 'Periods',
    'procurement.year': 'Gads',
    'procurement.loading': 'Ielādē iepirkumu KPI...',
    'procurement.failed': 'Neizdevās ielādēt iepirkumu KPI',
    'procurement.procurementLike': 'Iepirkumu proxy',
    'procurement.metricTotal': 'Kopējie izdevumi',
    'procurement.metricProxy': 'Iepirkumu proxy summa',
    'procurement.metricSingleBid': 'Single-bid īpatsvars (%)',
    'procurement.metricAvgBidders': 'Vid. pretendentu skaits',
    'procurement.metricDelta': 'Sākotnējais vs aktuālais līgums (%)',
    'procurement.topPurchasers': 'Top pasūtītāji',
    'procurement.topSuppliers': 'Top piegādātāji',
    'procurement.entity': 'Subjekts',
    'procurement.amount': 'Summa (€M)',
    'procurement.share': 'Daļa (%)',
    'procurement.noSuppliers': 'Piegādātāju dati nav pieejami izvēlētajā resursā',
    'procurement.notes': 'Piezīmes par datu pārklājumu',
    'procurement.source': 'Avots',
    'debt.title': 'Ārējais parāds un apkalpošanas izmaksas',
    'debt.subtitle': 'Parāds uz vienu iedzīvotāju, parāda slogs un apkalpošanas izmaksas',
    'debt.loading': 'Ielādē ārējā parāda datus...',
    'debt.failed': 'Neizdevās ielādēt ārējā parāda datus',
    'debt.year': 'Gads',
    'debt.selectedYear': 'Izvēlētais gads',
    'debt.period': 'Pieejamais periods',
    'debt.externalDebtEur': 'Ārējais parāds (€M)',
    'debt.externalDebtUsd': 'Ārējais parāds ($M)',
    'debt.perCapitaEur': 'Parāds uz 1 iedzīvotāju (€)',
    'debt.debtPctGdp': 'Ārējais parāds (% no IKP)',
    'debt.population': 'Iedzīvotāji (M)',
    'debt.serviceCostEur': 'Parāda apkalpošana (€M)',
    'debt.interestCostEur': 'Procentu maksājumi (€M)',
    'debt.serviceExports': 'Parāda apkalpošana (% no eksporta)',
    'debt.chartTitle': 'Ārējā parāda dinamika',
    'debt.chartSubtitle': 'Parāds un apkalpošana pa gadiem ($M)',
    'debt.lineDebt': 'Ārējais parāds',
    'debt.lineService': 'Parāda apkalpošana',
    'debt.basis': 'Datu bāze',
    'debt.basis.external_debt_world_bank': 'Pasaules Bankas ārējā parāda rādītāji',
    'debt.basis.central_government_debt_proxy': 'Valdības parāda proxy (ārējais nav pieejams)',
    'debt.basis.government_debt_pct_proxy': 'Valdības parāds no %IKP proxy',
    'debt.basis.model_debt_ratio_proxy': 'Modelēts 30% no IKP proxy',
    'debt.basis.unknown': 'Nav zināms',
    'debt.source': 'Avots',
    'debtFlow.title': 'Parāda apkalpošana un procenti: datu plūsma',
    'debtFlow.subtitle': 'Atsevišķa plūsma no parāda apjoma uz apkalpošanas un procentu izmaksām',
    'debtFlow.loading': 'Ielādē parāda plūsmas datus...',
    'debtFlow.failed': 'Neizdevās ielādēt parāda plūsmas datus',
    'debtFlow.serviceEur': 'Parāda apkalpošana (€M)',
    'debtFlow.interestEur': 'Procentu maksājumi (€M)',
    'debtFlow.principalOtherEur': 'Pamatsumma + citi maksājumi (€M)',
    'debtFlow.serviceToDebtRate': 'Apkalpošana pret parādu (%)',
    'debtFlow.interestShare': 'Procentu daļa apkalpošanā (%)',
    'debtFlow.stockEur': 'Parāda apjoms (€M)',
    'debtFlow.chartTitle': 'Debt service & Interest plūsma',
    'debtFlow.chartSubtitle': 'Sankey sadalījums izvēlētajam gadam',
    'debtFlow.noFlowData': 'Nepietiek datu, lai izveidotu plūsmu izvēlētajam gadam.',
    'debtFlow.cappedNote':
      'Piezīme: procentu vērtība pārsniedza apkalpošanas summu, tāpēc plūsmā tā tika ierobežota līdz 100% no apkalpošanas.',
    'debtFlow.node.stock': 'Parāda apjoms',
    'debtFlow.node.service': 'Parāda apkalpošana',
    'debtFlow.node.interest': 'Procentu maksājumi',
    'debtFlow.node.principalOther': 'Pamatsumma + citi',
    'construction.title': 'Būvniecība un investīciju sadalījums',
    'construction.subtitle': 'Publisko (valsts + pašvaldību) kapitālieguldījumu proxy pa gadiem',
    'construction.loading': 'Ielādē būvniecības datus...',
    'construction.failed': 'Neizdevās ielādēt būvniecības datus',
    'construction.year': 'Gads',
    'construction.selectedYear': 'Izvēlētais gads',
    'construction.period': 'Pieejamais periods',
    'construction.valueAdded': 'Būvniecības pievienotā vērtība (€M)',
    'construction.shareGdp': 'Būvniecība (% no IKP)',
    'construction.totalInvestment': 'Publisko kapitālieguldījumu proxy (€M)',
    'construction.privateInvestment': 'Privātās investīcijas (€M)',
    'construction.publicSoeProxyInvestment': 'Publiskās/SOE proxy investīcijas (€M)',
    'construction.privateShare': 'Privāto investīciju daļa (%)',
    'construction.descriptionTitle': 'Gada apraksts',
    'construction.descriptionLine1':
      '{year}. gadā privātās investīcijas veidoja {privateShare}% no kopējām investīcijām, publiskās/SOE proxy – {publicShare}%.',
    'construction.descriptionLinePublicOnly':
      '{year}. gadā pieejams publisko (valsts + pašvaldību) kapitālieguldījumu proxy: €{publicAmount}M.',
    'construction.descriptionLine2':
      'Būvniecības pievienotā vērtība bija €{valueAdded}M jeb {gdpShare}% no IKP.',
    'construction.chartTitle': 'Privātās vs publiskās/SOE proxy investīcijas',
    'construction.chartSubtitle': 'Stabiņi = investīciju summa (€M), līnija = būvniecības daļa IKP (%)',
    'construction.legendPrivate': 'Privātās investīcijas',
    'construction.legendPublicSoe': 'Publiskās/SOE proxy investīcijas',
    'construction.legendConstructionShare': 'Būvniecība (% no IKP)',
    'construction.source': 'Avots',
    'regionalMap.title': 'Latvijas reģionu fiskālā bilance',
    'regionalMap.netReceiver': 'Neto saņēmējs',
    'regionalMap.netContributor': 'Neto iemaksātājs',
    'regionalMap.fiscalDetail': '{area} — fiskālā detalizācija',
    'regionalMap.taxesPaid': 'Samaksātie nodokļi',
    'regionalMap.budgetReceived': 'Saņemtais budžets',
    'regionalMap.fiscalBalance': 'Fiskālā bilance',
    'regionalMap.scenarioImpactYear1': 'Scenārija ietekme (1. gads)',
    'regionalMap.jobs': 'darbvietas',
    'map.title': 'Latvijas interaktīvā karte',
    'map.subtitle': 'Reģioni, pilsētas un ostas',
    'map.legend.positive': 'Pozitīva ietekme',
    'map.legend.negative': 'Negatīva ietekme',
    'map.legend.neutral': 'Neitrāla ietekme',
    'map.legend.capital': 'Galvaspilsēta',
    'map.legend.port': 'Osta',
    'map.source': 'Avots',
    'regionalImpact.title': 'Reģionālā ietekme pa teritorijām',
    'regionalImpact.area': 'Teritorija',
    'regionalImpact.year': '{year}. gads',
    'regionalImpact.gdp': 'IKP %',
    'regionalImpact.jobs': 'Darbvietas',
    'investment.title': 'Ietekme uz investīcijām',
    'investment.year': '{year}. gads',
    'investment.public': 'Publiskās',
    'investment.private': 'Privātās',
    'investment.fdi': 'ĀTI',
    'investment.total': 'Kopā',
    'details.revenueTitle': 'Ieņēmumu avoti',
    'details.expenditureTitle': 'Izdevumi (Saeimas balsojuma dalījums)',
    'details.total': 'Kopā',
    'transparency.title': 'Caurskatāmība un modeļa informācija',
    'transparency.confidence': '{confidence} pārliecība',
    'transparency.model': 'Modelis',
    'transparency.modelHelp.aria': 'Informācija par modeļa pielietojumu un ierobežojumiem',
    'transparency.modelHelp.title': 'Modeļa lietojuma robežas',
    'transparency.modelHelp.subtitle': 'Modelis ir paredzēts politikas virziena novērtēšanai un alternatīvu salīdzināšanai, nevis precīzai punktveida prognozēšanai.',
    'transparency.modelHelp.goodFor': 'Modelis ir piemērots',
    'transparency.modelHelp.goodFor.1': 'Virzieniskam ietekmes vērtējumam: vai politika, visticamāk, uzlabos vai pasliktinās IKP, nodarbinātību un fiskālo bilanci.',
    'transparency.modelHelp.goodFor.2': 'Alternatīvu relatīvai salīdzināšanai: scenārijs A pret scenāriju B pie vienādiem pieņēmumiem.',
    'transparency.modelHelp.goodFor.3': 'Cēloņmehānisma skaidrošanai: kā ietekme izplatās caur nodokļiem, publiskajiem izdevumiem, darba tirgu un investīcijām.',
    'transparency.modelHelp.goodFor.4': 'Jutīguma analīzei: kā rezultāti mainās, mainot galvenos parametrus (piemēram, multiplikatorus).',
    'transparency.modelHelp.badFor': 'Modelis nav paredzēts',
    'transparency.modelHelp.badFor.1': 'Precīzām punktveida prognozēm (piemēram, “IKP nākamgad būs tieši 2,3 %”).',
    'transparency.modelHelp.badFor.2': 'Ļoti lieliem strukturāliem režīma šokiem, kas pārrauj vēsturiskās sakarības.',
    'transparency.modelHelp.badFor.3': 'Politiskās īstenojamības prognozēšanai (piemēram, vai Saeima pieņems konkrētu risinājumu).',
    'transparency.modelHelp.badFor.4': 'Retu sistēmisku krīžu prognozēšanai (karš, pandēmija, banku panika).',
    'transparency.assumptions': 'Pieņēmumi',
    'transparency.caveats': 'Ierobežojumi',
    'notFound.title': 'Ups! Lapa nav atrasta',
    'notFound.return': 'Atgriezties sākumā',
  },
  en: {
    'header.title': 'Latvia Government Budget Flow Dashboard',
    'header.subtitle': 'Fiscal Transparency & Policy Simulation',
    'header.home': 'Home',
    'header.savedViews': 'Saved Views',
    'header.docs': 'Docs',
    'header.data': 'Data: A',
    'header.dataFreshness': 'Data Freshness',
    'header.dataFreshness.stateBudget': 'State budget vote divisions: 12 days old',
    'header.dataFreshness.csb': 'CSB Latvia: 5 days old',
    'header.dataFreshness.ioTables': 'IO Tables: 45 days old',
    'header.langLabel': 'Language',
    'index.detailsButton': 'Revenue & Expenditure Details',
    'index.tab.impact': 'Impact',
    'index.tab.why': 'Why',
    'index.tab.map': 'Map',
    'index.tab.flow': 'Flow',
    'index.tab.details': 'Details',
    'globalAsk.title': 'Ask Fiscal AI',
    'globalAsk.placeholder': 'Ask a fiscal question (e.g., simulate 2nd pension pillar removal)',
    'globalAsk.parseFailed': 'Policy parse failed',
    'globalAsk.decision.auto_proceed':
      'High confidence: simulation will run automatically.',
    'globalAsk.decision.proceed_with_warning':
      'Good confidence with assumptions: simulation will run with warning.',
    'globalAsk.decision.require_confirmation':
      'Moderate confidence: review interpretation and confirm before simulation.',
    'globalAsk.decision.blocked_for_clarification':
      'Blocked: clarify missing details before simulation.',
    'globalAsk.parseFailedFallback': '{message} Running simulation without parser.',
    'globalAsk.failedToParse': 'Failed to parse policy',
    'globalAsk.parser': 'Parser',
    'globalAsk.confidence': 'Confidence',
    'globalAsk.type': 'Type',
    'globalAsk.category': 'Category',
    'globalAsk.policyInterpretation': 'Policy interpretation',
    'globalAsk.reasoning': 'Reasoning',
    'globalAsk.parameterChanges': 'Parameter changes',
    'globalAsk.ambiguities': 'Ambiguities',
    'globalAsk.runWithInterpretation': 'Run simulation with this interpretation',
    'globalAsk.clarificationRequired': 'Clarification required',
    'globalAsk.answerPlaceholder': 'Type answer...',
    'globalAsk.reparse': 'Re-parse with clarifications',
    'quickPrompt.1': 'Simulate removing the 2nd pension pillar',
    'quickPrompt.2': 'What if we increase health spending by €100M?',
    'quickPrompt.3': 'Cut defence budget by 20%',
    'quickPrompt.4': 'Redirect EU funds to education',
    'horizon.gdp': 'GDP',
    'horizon.jobs': 'Jobs',
    'horizon.budget': 'Budget',
    'horizon.inflation': 'Inflation',
    'horizon.year': 'Year {year}',
    'horizon.yearImpact': 'Year {year} impact',
    'horizon.askAbove': 'Ask a question above',
    'why.title': 'Why This Happens',
    'why.causalChain': 'Causal Chain',
    'why.keyDrivers': 'Key Drivers',
    'why.winners': 'Winners',
    'why.losers': 'Losers',
    'interactive.title': 'Budget flow: from revenues to expenditures',
    'interactive.subtitle': 'Interactive Sankey chart - hover over nodes and links for details',
    'interactive.revenue': 'Revenue',
    'interactive.expenditure': 'Expenditure',
    'interactive.period': 'Period',
    'interactive.year': 'Year',
    'interactive.loading': 'Loading budget allocation from data.gov.lv...',
    'interactive.loadFail': 'Could not load online data. Showing local fallback data.',
    'interactive.source': 'Source',
    'sankey.title': 'How much from €1 paid in taxes is allocated to sectors?',
    'sankey.subtitle': 'Saeima vote logic by ministries and spending lines',
    'sankey.total': 'Total',
    'sankey.period': 'Period',
    'sankey.loading': 'Loading budget allocation from data.gov.lv...',
    'sankey.loadFail': 'Could not load online data. Showing local fallback data.',
    'sankey.chartTitle': 'All ministries: vertical bar chart',
    'sankey.chartSubtitle': 'Full allocation by spending line ({count} records)',
    'sankey.tableTitle': 'Open data: expenditure table by ministries',
    'sankey.colMinistry': 'Ministry / spending line',
    'sankey.colEuro': 'From €1 (cents)',
    'sankey.colAmount': 'Amount (€M)',
    'sankey.colShare': 'Share (%)',
    'sankey.source': 'Source',
    'sankey.cents': 'cents',
    'sankey.amountLabel': 'Amount',
    'history.title': 'Expenditure Change Explorer',
    'history.subtitle': 'Switch groups and view 1 year or full-period changes since 2010.',
    'history.period': 'Available period',
    'history.loading': 'Loading historical expenditure data...',
    'history.failed': 'Failed to load history',
    'history.group': 'Expenditure group',
    'history.tabSingle': '1 year view',
    'history.tabAll': 'all years view',
    'history.selectedYear': 'Selected year',
    'history.yearRange': 'Year range',
    'history.yearsShown': 'Years shown',
    'history.metricAmount': 'Amount (€M)',
    'history.metricBaseEur': 'vs base (€M)',
    'history.metricBasePct': 'vs base (%)',
    'history.metricYoyPct': 'YoY (%)',
    'history.na': 'n/a',
    'period.from': 'From',
    'period.to': 'To',
    'period.modeYear': 'Year',
    'period.modeRange': 'Range',
    'revenueHistory.title': 'Revenue Source Change Explorer',
    'revenueHistory.subtitle': 'Vertical color bar chart by source with YoY changes (starting 2010 when data is available).',
    'revenueHistory.loading': 'Loading revenue source history...',
    'revenueHistory.failed': 'Failed to load revenue source history',
    'revenueHistory.total': 'Total',
    'revenueHistory.period': 'Available period',
    'revenueHistory.selectedYear': 'Selected year',
    'revenueHistory.range': 'Year range',
    'revenueHistory.rangeApplied': 'Applied range',
    'revenueHistory.yoyBasis': 'YoY base year',
    'revenueHistory.chartTitle': 'Revenue sources: vertical bar chart',
    'revenueHistory.chartSubtitle': 'Different color per revenue source',
    'revenueHistory.tableTitle': 'Revenue source table',
    'revenueHistory.amount': 'Amount',
    'revenueHistory.yoy': 'YoY',
    'revenueHistory.colSource': 'Revenue source',
    'revenueHistory.colAmount': 'Amount (€M)',
    'revenueHistory.colShare': 'Share (%)',
    'revenueHistory.colYoy': 'YoY (%)',
    'revenueHistory.otherBreakdown': 'Other revenue breakdown',
    'trade.title': 'Trade By Country',
    'trade.subtitle': 'Trade balance and values by partner countries',
    'trade.loading': 'Loading trade data...',
    'trade.failed': 'Failed to load trade data',
    'trade.period': 'Available period',
    'trade.year': 'Selected year',
    'trade.selectorMode': 'View mode',
    'trade.rangeNote': 'In range mode, values are summed across selected years.',
    'trade.exports': 'Exports',
    'trade.imports': 'Imports',
    'trade.deficit': 'Trade Deficit',
    'trade.surplus': 'Trade Surplus',
    'trade.balance': 'Balance',
    'trade.chartTitle': 'Balance by country',
    'trade.chartSubtitle': 'Green = surplus, red = deficit',
    'trade.tableTitle': 'Top partner countries',
    'trade.country': 'Country',
    'trade.exportsShort': 'Exports (€M)',
    'trade.importsShort': 'Imports (€M)',
    'trade.balanceShort': 'Balance (€M)',
    'economyStructure.title': 'Economy Structure and Remittances',
    'economyStructure.subtitle': 'Services vs production, export groups, and money sent home from abroad',
    'economyStructure.loading': 'Loading economy structure data...',
    'economyStructure.failed': 'Failed to load economy structure data',
    'economyStructure.period': 'Available period',
    'economyStructure.year': 'Selected year',
    'economyStructure.selectorMode': 'View mode',
    'economyStructure.rangeNote': 'In range mode, amounts are summed while percentage metrics are averaged across years.',
    'economyStructure.totalExports': 'Total exports',
    'economyStructure.servicesEconomy': 'Services economy (% of GDP)',
    'economyStructure.productionEconomy': 'Production economy (% of GDP)',
    'economyStructure.agriculture': 'Agriculture (% GDP)',
    'economyStructure.industry': 'Industry (% GDP)',
    'economyStructure.manufacturingExports': 'Manufacturing+wood in goods exports (%)',
    'economyStructure.itExports': 'ICT services (share of commercial service exports, %)',
    'economyStructure.remittancesValue': 'Remittances inflow ($M)',
    'economyStructure.remittancesShare': 'Remittances (% GDP)',
    'economyStructure.chartTitle': 'Export composition by group',
    'economyStructure.chartSubtitle': 'Goods exports (TOTAL) by CN2 groupings',
    'economyStructure.tableTitle': 'Export groups table',
    'economyStructure.shareMiniTitle': 'Export shares (%)',
    'economyStructure.viewTable': 'Table',
    'economyStructure.viewChart': 'Chart',
    'economyStructure.denominatorNote': 'Note: ICT share is based on services exports, while the chart below is goods exports (CN2) only.',
    'economyStructure.groupCol': 'Group',
    'economyStructure.amountCol': 'Amount (€M)',
    'economyStructure.shareCol': 'Share (%)',
    'economyStructure.amount': 'Amount',
    'economyStructure.group.manufacturing_other': 'Manufacturing (other goods)',
    'economyStructure.group.lumber_wood': 'Wood and paper',
    'economyStructure.group.agriculture_food': 'Agriculture and food',
    'economyStructure.group.other_goods': 'Other goods',
    'expenditurePositions.title': 'Largest Expenditure Positions',
    'expenditurePositions.subtitle': 'Top spending by EKK, programs, institutions, or ministries',
    'expenditurePositions.total': 'Total expenditure',
    'expenditurePositions.period': 'Period',
    'expenditurePositions.year': 'Year',
    'expenditurePositions.group': 'Group by',
    'expenditurePositions.group.ekk': 'EKK',
    'expenditurePositions.group.program': 'Program',
    'expenditurePositions.group.institution': 'Institution',
    'expenditurePositions.group.ministry': 'Ministry',
    'expenditurePositions.loading': 'Loading expenditure positions...',
    'expenditurePositions.failed': 'Failed to load expenditure positions',
    'expenditurePositions.chartTitle': 'Top positions: vertical bar chart',
    'expenditurePositions.tableTitle': 'Top positions table',
    'expenditurePositions.colPosition': 'Position',
    'expenditurePositions.colAmount': 'Amount (€M)',
    'expenditurePositions.colShare': 'Share (%)',
    'expenditurePositions.amount': 'Amount',
    'expenditurePositions.source': 'Source',
    'procurement.title': 'Procurement Optimization KPI',
    'procurement.subtitle': 'Procurement proxy + top buyers/suppliers from available data',
    'procurement.period': 'Period',
    'procurement.year': 'Year',
    'procurement.loading': 'Loading procurement KPI...',
    'procurement.failed': 'Failed to load procurement KPI',
    'procurement.procurementLike': 'Procurement proxy',
    'procurement.metricTotal': 'Total expenditure',
    'procurement.metricProxy': 'Procurement proxy amount',
    'procurement.metricSingleBid': 'Single-bid share (%)',
    'procurement.metricAvgBidders': 'Avg bidder count',
    'procurement.metricDelta': 'Initial vs actual contract (%)',
    'procurement.topPurchasers': 'Top purchasers',
    'procurement.topSuppliers': 'Top suppliers',
    'procurement.entity': 'Entity',
    'procurement.amount': 'Amount (€M)',
    'procurement.share': 'Share (%)',
    'procurement.noSuppliers': 'Supplier data is unavailable in selected source',
    'procurement.notes': 'Coverage notes',
    'procurement.source': 'Source',
    'debt.title': 'External Debt and Servicing Costs',
    'debt.subtitle': 'Per-person debt burden, debt pressure, and servicing costs',
    'debt.loading': 'Loading external debt data...',
    'debt.failed': 'Failed to load external debt data',
    'debt.year': 'Year',
    'debt.selectedYear': 'Selected year',
    'debt.period': 'Available period',
    'debt.externalDebtEur': 'External debt (€M)',
    'debt.externalDebtUsd': 'External debt ($M)',
    'debt.perCapitaEur': 'Debt per resident (€)',
    'debt.debtPctGdp': 'External debt (% of GDP)',
    'debt.population': 'Population (M)',
    'debt.serviceCostEur': 'Debt service (€M)',
    'debt.interestCostEur': 'Interest payments (€M)',
    'debt.serviceExports': 'Debt service (% of exports)',
    'debt.chartTitle': 'External debt trend',
    'debt.chartSubtitle': 'Debt and servicing by year ($M)',
    'debt.lineDebt': 'External debt',
    'debt.lineService': 'Debt service',
    'debt.basis': 'Data basis',
    'debt.basis.external_debt_world_bank': 'World Bank external debt indicators',
    'debt.basis.central_government_debt_proxy': 'Government debt proxy (external unavailable)',
    'debt.basis.government_debt_pct_proxy': 'Government debt from %GDP proxy',
    'debt.basis.model_debt_ratio_proxy': 'Modeled 30% of GDP proxy',
    'debt.basis.unknown': 'Unknown',
    'debt.source': 'Source',
    'debtFlow.title': 'Debt Service & Interest Data Flow',
    'debtFlow.subtitle': 'Separate flow from debt stock into annual servicing and interest costs',
    'debtFlow.loading': 'Loading debt-flow data...',
    'debtFlow.failed': 'Failed to load debt-flow data',
    'debtFlow.serviceEur': 'Debt service (€M)',
    'debtFlow.interestEur': 'Interest payments (€M)',
    'debtFlow.principalOtherEur': 'Principal + other payments (€M)',
    'debtFlow.serviceToDebtRate': 'Servicing to debt ratio (%)',
    'debtFlow.interestShare': 'Interest share of service (%)',
    'debtFlow.stockEur': 'Debt stock (€M)',
    'debtFlow.chartTitle': 'Debt service & interest flow',
    'debtFlow.chartSubtitle': 'Sankey breakdown for selected year',
    'debtFlow.noFlowData': 'Not enough data to build flow for selected year.',
    'debtFlow.cappedNote':
      'Note: interest exceeded debt service in source data, so it was capped to 100% of servicing for flow consistency.',
    'debtFlow.node.stock': 'Debt stock',
    'debtFlow.node.service': 'Debt service',
    'debtFlow.node.interest': 'Interest payments',
    'debtFlow.node.principalOther': 'Principal + other',
    'construction.title': 'Construction and Investment Split',
    'construction.subtitle': 'Public (state + municipal) capital investment proxy by year',
    'construction.loading': 'Loading construction data...',
    'construction.failed': 'Failed to load construction data',
    'construction.year': 'Year',
    'construction.selectedYear': 'Selected year',
    'construction.period': 'Available period',
    'construction.valueAdded': 'Construction value added (€M)',
    'construction.shareGdp': 'Construction (% of GDP)',
    'construction.totalInvestment': 'Public capital investment proxy (€M)',
    'construction.privateInvestment': 'Private investment (€M)',
    'construction.publicSoeProxyInvestment': 'Public/SOE proxy investment (€M)',
    'construction.privateShare': 'Private investment share (%)',
    'construction.descriptionTitle': 'Year description',
    'construction.descriptionLine1':
      'In {year}, private investment accounted for {privateShare}% of total investment, while public/SOE proxy accounted for {publicShare}%.',
    'construction.descriptionLinePublicOnly':
      'For {year}, available value is public (state + municipal) capital investment proxy: €{publicAmount}M.',
    'construction.descriptionLine2':
      'Construction value added was €{valueAdded}M, equal to {gdpShare}% of GDP.',
    'construction.chartTitle': 'Private vs public/SOE proxy investment',
    'construction.chartSubtitle': 'Bars = investment amount (€M), line = construction share of GDP (%)',
    'construction.legendPrivate': 'Private investment',
    'construction.legendPublicSoe': 'Public/SOE proxy investment',
    'construction.legendConstructionShare': 'Construction (% of GDP)',
    'construction.source': 'Source',
    'regionalMap.title': 'Latvia Regional Fiscal Balance',
    'regionalMap.netReceiver': 'Net receiver',
    'regionalMap.netContributor': 'Net contributor',
    'regionalMap.fiscalDetail': '{area} - Fiscal Detail',
    'regionalMap.taxesPaid': 'Taxes Paid',
    'regionalMap.budgetReceived': 'Budget Received',
    'regionalMap.fiscalBalance': 'Fiscal Balance',
    'regionalMap.scenarioImpactYear1': 'Scenario Impact (Yr 1)',
    'regionalMap.jobs': 'jobs',
    'map.title': 'Interactive Latvia Map',
    'map.subtitle': 'Regions, cities and ports',
    'map.legend.positive': 'Positive impact',
    'map.legend.negative': 'Negative impact',
    'map.legend.neutral': 'Neutral impact',
    'map.legend.capital': 'Capital',
    'map.legend.port': 'Port',
    'map.source': 'Source',
    'regionalImpact.title': 'Regional Impact by Area',
    'regionalImpact.area': 'Area',
    'regionalImpact.year': 'Year {year}',
    'regionalImpact.gdp': 'GDP %',
    'regionalImpact.jobs': 'Jobs',
    'investment.title': 'Investment Impact',
    'investment.year': 'Year {year}',
    'investment.public': 'Public',
    'investment.private': 'Private',
    'investment.fdi': 'FDI',
    'investment.total': 'Total',
    'details.revenueTitle': 'Revenue Sources',
    'details.expenditureTitle': 'Expenditures (Saeima Vote Divisions)',
    'details.total': 'Total',
    'transparency.title': 'Transparency & Model Info',
    'transparency.confidence': '{confidence} confidence',
    'transparency.model': 'Model',
    'transparency.modelHelp.aria': 'What this model can and cannot do',
    'transparency.modelHelp.title': 'How to use this model',
    'transparency.modelHelp.subtitle': 'Use it for policy direction and option comparison, not exact forecasting.',
    'transparency.modelHelp.goodFor': 'What it is good for',
    'transparency.modelHelp.goodFor.1': 'Directional impact: whether a policy is more likely to improve or worsen GDP, jobs, and budget balance.',
    'transparency.modelHelp.goodFor.2': 'Relative comparison: Option A vs Option B under the same assumptions.',
    'transparency.modelHelp.goodFor.3': 'Mechanism clarity: how effects propagate through taxes, spending, labor, and investment.',
    'transparency.modelHelp.goodFor.4': 'Sensitivity checks: what changes when assumptions (for example multipliers) are adjusted.',
    'transparency.modelHelp.badFor': 'What it is not good for',
    'transparency.modelHelp.badFor.1': 'Precise point forecasts (for example “GDP will be exactly 2.3% next year”).',
    'transparency.modelHelp.badFor.2': 'Very large regime shifts that break historical relationships.',
    'transparency.modelHelp.badFor.3': 'Political feasibility predictions (whether parliament will pass it).',
    'transparency.modelHelp.badFor.4': 'Black-swan crisis prediction (war, pandemic, banking panic).',
    'transparency.assumptions': 'Assumptions',
    'transparency.caveats': 'Caveats',
    'notFound.title': 'Oops! Page not found',
    'notFound.return': 'Return to Home',
  },
};

function resolveMessage(locale: Locale, key: string): string {
  return DICTIONARY[locale][key] ?? DICTIONARY.en[key] ?? key;
}

function interpolate(template: string, vars?: Record<string, string | number>): string {
  if (!vars) return template;
  return template.replace(/\{(\w+)\}/g, (_, token: string) =>
    Object.prototype.hasOwnProperty.call(vars, token) ? String(vars[token]) : `{${token}}`
  );
}

const I18nContext = createContext<I18nContextValue | null>(null);

export function I18nProvider({ children }: { children: ReactNode }) {
  const [locale, setLocale] = useState<Locale>(() => {
    if (typeof window === 'undefined') return 'lv';
    const stored = window.localStorage.getItem(STORAGE_KEY);
    return stored === 'en' ? 'en' : 'lv';
  });

  useEffect(() => {
    if (typeof window !== 'undefined') {
      window.localStorage.setItem(STORAGE_KEY, locale);
      document.documentElement.lang = locale;
    }
  }, [locale]);

  const value = useMemo<I18nContextValue>(
    () => ({
      locale,
      setLocale,
      t: (key: string, vars?: Record<string, string | number>) =>
        interpolate(resolveMessage(locale, key), vars),
    }),
    [locale]
  );

  return <I18nContext.Provider value={value}>{children}</I18nContext.Provider>;
}

export function useI18n(): I18nContextValue {
  const ctx = useContext(I18nContext);
  if (!ctx) {
    throw new Error('useI18n must be used inside I18nProvider');
  }
  return ctx;
}
